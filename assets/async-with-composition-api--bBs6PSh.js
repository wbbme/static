import{u as l,c as n,w as i,_ as r,o as h,a as s,d as t}from"./app-NfkmQghJ.js";const p=s("div",{class:"prose m-auto slide-enter-content"},[s("p",null,"There is a major caveat when working with asynchronous functions in Vue Composition API, that I believe many of you have ever come across. I have acknowledged it for a while from somewhere, but every time I want to have a detailed reference and share to others, I can’t find it’s documented anywhere. So, I am thinking about writing one, with a detailed explanation while sorting out the possible solutions for you."),s("ul",null,[s("li",null,[s("a",{href:"#the-problem"},"The Problem")]),s("li",null,[s("a",{href:"#the-mechanism"},"The Mechanism")]),s("li",null,[s("a",{href:"#the-limitation"},"The Limitation")]),s("li",null,[s("a",{href:"#the-solutions"},"The Solutions")])]),s("h2",{id:"the-problem",tabindex:"-1"},[t("The Problem "),s("a",{class:"header-anchor",href:"#the-problem","aria-hidden":"true"},"#")]),s("p",null,[t("When using asynchronous "),s("code",null,"setup()"),t(", "),s("strong",null,[t("you have to use effects and lifecycle hooks before the first "),s("code",null,"await"),t(" statement.")]),t(" ("),s("a",{href:"https://github.com/vuejs/rfcs/discussions/234",target:"_blank",rel:"noopener"},"details"),t(")")]),s("p",null,"For example:"),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"import"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," onUnmounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," ref"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," watch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," from"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}}," '"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"vue"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," default"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," defineAsyncComponent"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"({")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  async"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"() {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"counter"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," ref"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"0"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    watch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"counter"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},", () => "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"counter"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"value"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"))")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // OK!")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(() => "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"Mounted"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"))")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // the await statement")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"    await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," someAsyncFunction"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"() "),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// <-----------")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // does NOT work!")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    onUnmounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(() => "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"Unmounted"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"))")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // still works, but does not auto-dispose")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // after the component is destroyed (memory leak!)")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    watch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"counter"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},", () => "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"counter"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"value"),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}}," *"),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}}," 2"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"))")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"})")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("After the "),s("code",null,"await"),t(" statement,")]),s("p",null,[t("the following functions will be "),s("strong",null,"limited"),t(" (no auto-dispose):")]),s("ul",null,[s("li",null,[s("code",null,"watch"),t(" / "),s("code",null,"watchEffect")]),s("li",null,[s("code",null,"computed")]),s("li",null,[s("code",null,"effect")])]),s("p",null,[t("the following functions will "),s("strong",null,"not work"),t(":")]),s("ul",null,[s("li",null,[s("code",null,"onMounted"),t(" / "),s("code",null,"onUnmounted"),t(" / "),s("code",null,"onXXX")]),s("li",null,[s("code",null,"provide"),t(" / "),s("code",null,"inject")]),s("li",null,[s("code",null,"getCurrentInstance")]),s("li",null,"…")]),s("h2",{id:"the-mechanism",tabindex:"-1"},[t("The Mechanism "),s("a",{class:"header-anchor",href:"#the-mechanism","aria-hidden":"true"},"#")]),s("p",null,[t("Let’s take the "),s("code",null,"onMounted"),t(" API as an example. As we know, "),s("code",null,"onMounted"),t(" is a hook that registers a listener when the current component gets mounted. Notice that "),s("code",null,"onMounted"),t(" (along with other composition APIs) are "),s("strong",null,"global"),t(', for what I mean "global" is that it can be imported and called anywhere - there is '),s("strong",null,"no local context"),t(" bound to it.")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// local: `onMounted` is a method of `component` that bound to it")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"/* ... */"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// global: `onMounted` can be called without context")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"/* ... */"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("So, how does "),s("code",null,"onMounted"),t(" know what component is being mounted?")]),s("p",null,"Vue takes an interesting approach to solve this. It uses an internal variable to record the current component instance. There is a simplified code:"),s("p",null,"When Vue mounts a component, it stores the instance in a global variable. When hooks been called inside the setup function, it will use the global variable to get the current component instance."),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"let"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}}," null")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// (pseudo code)")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}}," function"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," mountComponent"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  const"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," instance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," createComponent"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // hold the previous instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  const"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," prev"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," currentInstance")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // set the instance to global")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," instance")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // hooks called inside the `setup()` will have")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // the `currentInstance` as the context")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // restore the previous instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," prev")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"}")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("A simplified "),s("code",null,"onMounted"),t(" implementation would be like:")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// (pseudo code)")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}}," function"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"fn"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"  if"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ("),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"!"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    warn"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},`"onMounted" can't be called outside of component setup()`),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"    return")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  }")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"  // bound listener to the current instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"onMounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"fn"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"}")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("With this approach, as long as the "),s("code",null,"onMounted"),t(" is called inside the component "),s("code",null,"setup()"),t(", it will be able to get the instance of the current component.")]),s("h2",{id:"the-limitation",tabindex:"-1"},[t("The Limitation "),s("a",{class:"header-anchor",href:"#the-limitation","aria-hidden":"true"},"#")]),s("p",null,"So far so good, but what’s wrong with asynchronous functions?"),s("p",null,[t("The implementation would work based on the fact that JavaScript is "),s("strong",null,"single-threaded"),t(". Single thread makes sure the following statements will be executed right next to each other, which in other words, there is no one could accidentally modify the "),s("code",null,"currentInstance"),t(" at the same time (a.k.a. it’s "),s("a",{href:"https://stackoverflow.com/questions/52196678/what-are-atomic-operations-for-newbies",target:"_blank",rel:"noopener"},"atomic"),t(").")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," prev")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("The situation changes when the "),s("code",null,"setup()"),t(" is asynchronous. Whenever you "),s("code",null,"await"),t(" a promise, you can think the engine paused the works here and went to do another task. If we "),s("code",null,"await"),t(" the function, during the time period, multiple components creation will change the global variable unpredictably and end up with a mess.")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"await"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," component"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()"),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}}," // atomic lost")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"currentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," prev")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("If we don’t use "),s("code",null,"await"),t(" to check the instance, calling the "),s("code",null,"setup()"),t(" function will make it finish the tasks before the first "),s("code",null,"await"),t(" statement, and the rest will be executed whenever the "),s("code",null,"await"),t(" statement is resolved.")]),s("div",{class:"grid grid-cols-2 gap-2 lt-sm:grid-cols-1"},[s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"async"),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}}," function"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"1"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"  await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," someAsyncFunction"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"  console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"2"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"}")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"3"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"4"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// output:")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"3")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"1")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"4")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"awaiting"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4C9A91","--s-light":"#2F798A"}},"2")]),t(`
`),s("span",{class:"line"})])])]),s("p",null,"This means, there is no way for Vue to know when will the asynchronous part been called from the outside, so there is also no way to bound the instance to the context."),s("h2",{id:"the-solutions",tabindex:"-1"},[t("The Solutions "),s("a",{class:"header-anchor",href:"#the-solutions","aria-hidden":"true"},"#")]),s("p",null,"This is actually a limitation of JavaScript itself, unless we have some new proposal to open the gate on the language level, we have to live with it."),s("p",null,"But to work around it, I have collected a few solutions for you to choose from based on your needs."),s("h3",{id:"remember-the-caveat-and-avoid-it",tabindex:"-1"},[t("Remember the Caveat and Avoid It "),s("a",{class:"header-anchor",href:"#remember-the-caveat-and-avoid-it","aria-hidden":"true"},"#")]),s("p",null,[t('This is, of course, an obvious "solution". You can try to move your effect and hooks before the first '),s("code",null,"await"),t(" statement and carefully remember not to have them after that again.")]),s("p",null,[t("Luckily, if you are using ESLint, you can have the "),s("a",{href:"https://eslint.vuejs.org/rules/no-watch-after-await.html",target:"_blank",rel:"noopener"},[s("code",null,"vue/no-watch-after-await")]),t(" and "),s("a",{href:"https://eslint.vuejs.org/rules/no-lifecycle-after-await.html",target:"_blank",rel:"noopener"},[s("code",null,"vue/no-lifecycle-after-await")]),t(" rules from "),s("a",{href:"https://eslint.vuejs.org/",target:"_blank",rel:"noopener"},[s("code",null,"eslint-plugin-vue")]),t(" enabled so it could warn you whenever you made some mistakes (they are enabled by default within the plugin presets).")]),s("h3",{id:"wrap-the-async-function-as-reactive-sync",tabindex:"-1"},[t('Wrap the Async Function as "Reactive Sync" '),s("a",{class:"header-anchor",href:"#wrap-the-async-function-as-reactive-sync","aria-hidden":"true"},"#")]),s("p",null,[t("In some situations, your logic might be relying on the data that fetched asynchronously. In this way, you could consider using the "),s("a",{href:"/posts/composable-vue-vueday-2021#async-to-sync"},"trick I have shared on VueDay 2021"),t(" to "),s("strong",null,"turn your async function into a sync reactive state"),t(".")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," fetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"https://api.github.com/"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"then"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"json"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"())")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user")]),t(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," ref"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"null"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"fetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"https://api.github.com/"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  ."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"then"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"json"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"())")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  ."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"then"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"res"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"value"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," res"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," computed"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"?."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"})])]),s("p",null,'This approach make the "connections" between your logic to resolve first, and then reactive updates when the asynchronous function get resolved and filled with data.'),s("p",null,[t("There is also some more general utilities for it from "),s("a",{href:"https://vueuse.org/",target:"_blank",rel:"noopener"},"VueUse"),t(":")]),s("h4",{id:"useasyncstate",tabindex:"-1"},[s("a",{href:"https://vueuse.org/useAsyncState",target:"_blank",rel:"noopener"},[s("code",null,"useAsyncState")]),t(),s("a",{class:"header-anchor",href:"#useasyncstate","aria-hidden":"true"},"#")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"import"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," useAsyncState"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," from"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}}," '"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"@vueuse/core"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"{"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," state"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," ready"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," useAsyncState"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"async "),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  const "),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"{"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," await"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," axios"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"get"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"https://api.github.com/"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"  return"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," { "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"})")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," computed"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," state"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"?."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"})])]),s("h4",{id:"usefetch",tabindex:"-1"},[s("a",{href:"https://vueuse.org/useFetch",target:"_blank",rel:"noopener"},[s("code",null,"useFetch")]),t(),s("a",{class:"header-anchor",href:"#usefetch","aria-hidden":"true"},"#")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"import"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," useFetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," from"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}}," '"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"@vueuse/core"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"{"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," isFetching"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," error"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," useFetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"https://api.github.com/"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," computed"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"?."),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"user"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"})])]),s("h3",{id:"explicitly-bound-the-instance",tabindex:"-1"},[t("Explicitly Bound the Instance "),s("a",{class:"header-anchor",href:"#explicitly-bound-the-instance","aria-hidden":"true"},"#")]),s("p",null,"Lifecycle hooks actually accept a second argument for setting the instance explicitly."),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," default"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," defineAsyncComponent"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"({")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  async"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"() {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // get and hold the instance before `await`")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"instance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," getCurrentInstance"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"    await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," someAsyncFunction"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"() "),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"// <-----------")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"    onUnmounted"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"      () => "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"console"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"log"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"Unmounted"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"),")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"      instance"),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}}," // <--- pass the instance to it")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"    )")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"})")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("However, the downside is that this solution "),s("strong",null,"does not work"),t(" with "),s("code",null,"watch"),t(" / "),s("code",null,"watchEffect"),t(" / "),s("code",null,"computed"),t(" / "),s("code",null,"provide"),t(" / "),s("code",null,"inject"),t(" as they does not accept the instance argument.")]),s("p",null,[t("To get the effects work, you could use the "),s("a",{href:"https://github.com/vuejs/rfcs/blob/master/active-rfcs/0041-reactivity-effect-scope.md",target:"_blank",rel:"noopener"},[s("code",null,"effectScope"),t(" API")]),t(" in the upcoming Vue 3.2.")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-ts"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"import"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," effectScope"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," from"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}}," '"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"vue"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," default"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," defineAsyncComponent"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"({")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  async"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"() {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // create the scope before `await`, so it will be bond to the instance")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"scope"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," effectScope"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    const "),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"data"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," someAsyncFunction"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()"),s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}}," // <-----------")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"    scope"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"run"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(() => {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"      /* Use `computed`, `watch`, etc. ... */")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"    })")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // the lifecycle hooks will not be available here,")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // you will need to combine it with the previous snippet")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // to have both lifecycle hooks and effects works.")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"})")]),t(`
`),s("span",{class:"line"})])]),s("h3",{id:"compile-time-magic",tabindex:"-1"},[t("Compile-time Magic! "),s("a",{class:"header-anchor",href:"#compile-time-magic","aria-hidden":"true"},"#")]),s("p",null,[t("In the recent "),s("a",{href:"https://github.com/vuejs/rfcs/blob/master/active-rfcs/0040-script-setup.md",target:"_blank",rel:"noopener"},[s("code",null,"<script setup>"),t(" proposal")]),t(" update, a new "),s("a",{href:"https://github.com/vuejs/rfcs/blob/master/active-rfcs/0040-script-setup.md#top-level-await",target:"_blank",rel:"noopener"},"compile-time magic"),t(" is introduced.")]),s("p",null,[t("The way it works is to inject a script after each "),s("code",null,"await"),t(" statement for restoring the current instance state.")]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-html"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"<"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"script"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},">")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  const"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," post"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," await"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," fetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"/api/post/1"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"then"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"json"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"())")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"</"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"script"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},">")]),t(`
`),s("span",{class:"line"})])]),s("pre",{class:"shiki shiki-themes vitesse-dark vitesse-light",style:{"--s-dark":"#dbd7caee","--s-light":"#393a34","--s-dark-bg":"#121212","--s-light-bg":"#ffffff"},tabindex:"0"},[s("code",{class:"language-js"},[s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"import"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," withAsyncContext"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," from"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}}," '"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"vue"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"'")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"export"),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," default"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"  async"),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," setup"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    let"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," __temp"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," __restore")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#CB7676","--s-light":"#AB5959"}},"    const"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," post")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"      ="),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ((["),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"__temp"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},","),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," __restore"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"]"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}}," withAsyncContext"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(()"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"        fetch"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#C98A7D","--s-light":"#B56959"}},"/api/post/1"),s("span",{style:{"--s-dark":"#C98A7D99","--s-light":"#B5695999"}},"`"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"then"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," =>"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," r"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"."),s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"json"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"())")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"      )),")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"      ("),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"__temp"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," ="),s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}}," await"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," __temp"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"),")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#80A665","--s-light":"#59873A"}},"      __restore"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"(),")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}},"      __temp"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},")")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // current instance context preserved")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#758575DD","--s-light":"#A0ADA0"}},"    // e.g. onMounted() will still work.")]),t(`
`),s("span",{class:"line"}),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#4D9375","--s-light":"#1E754F"}},"    return"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," {"),s("span",{style:{"--s-dark":"#BD976A","--s-light":"#B07D48"}}," post"),s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}}," }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"  }")]),t(`
`),s("span",{class:"line"},[s("span",{style:{"--s-dark":"#666666","--s-light":"#999999"}},"}")]),t(`
`),s("span",{class:"line"})])]),s("p",null,[t("With it, the async functions will "),s("strong",null,"just work"),t(" when using with "),s("code",null,"<script setup>"),t(". The only shame is it does not work outside of "),s("code",null,"<script setup>"),t(".")])],-1),k={__name:"async-with-composition-api",setup(d){const a={title:"Async with Composition API",description:"Notes about the caveat when using async functions in Vue Composition API.",date:"2021-07-16T08:00:00.000Z",lang:"en",duration:"17min",image:"https://antfu.me/og/async-with-composition-api.png",meta:[{property:"og:title",content:"Async with Composition API"},{name:"twitter:title",content:"Async with Composition API"},{name:"description",content:"Notes about the caveat when using async functions in Vue Composition API."},{property:"og:description",content:"Notes about the caveat when using async functions in Vue Composition API."},{name:"twitter:description",content:"Notes about the caveat when using async functions in Vue Composition API."},{property:"og:image",content:"https://antfu.me/og/async-with-composition-api.png"},{name:"twitter:image",content:"https://antfu.me/og/async-with-composition-api.png"},{name:"twitter:card",content:"summary_large_image"}]};return l({title:"Async with Composition API",meta:[{property:"og:title",content:"Async with Composition API"},{name:"twitter:title",content:"Async with Composition API"},{name:"description",content:"Notes about the caveat when using async functions in Vue Composition API."},{property:"og:description",content:"Notes about the caveat when using async functions in Vue Composition API."},{name:"twitter:description",content:"Notes about the caveat when using async functions in Vue Composition API."},{property:"og:image",content:"https://antfu.me/og/async-with-composition-api.png"},{name:"twitter:image",content:"https://antfu.me/og/async-with-composition-api.png"},{name:"twitter:card",content:"summary_large_image"}]}),(g,c)=>{const e=r;return h(),n(e,{frontmatter:a},{default:i(()=>[p]),_:1})}}};export{k as default};
